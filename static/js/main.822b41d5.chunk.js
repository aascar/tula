(this.webpackJsonptula=this.webpackJsonptula||[]).push([[0],{89:function(t,e,a){"use strict";a.r(e);var n=a(2),i=a(0),c=a.n(i),r=a(12),s=a.n(r),o=a(8),l=a(135),d=a(144),u=a(14),j=a(3),b=a(5),h=a(147),O=a(132),p=a(133),x=a(134),m=a(91),f=a(67),g=a.n(f),v=a(90),y=Object(b.a)((function(t){return{root:{margin:0,padding:t.spacing(2)},closeButton:{position:"absolute",right:t.spacing(1),top:t.spacing(1),color:t.palette.grey[500]}}}))((function(t){var e=t.children,a=t.classes,i=t.onClose,c=Object(j.a)(t,["children","classes","onClose"]);return Object(n.jsxs)(O.a,Object(u.a)(Object(u.a)({disableTypography:!0,className:a.root},c),{},{children:[Object(n.jsx)(v.a,{variant:"h6",children:e}),i?Object(n.jsx)(m.a,{"aria-label":"close",className:a.closeButton,onClick:i,children:Object(n.jsx)(g.a,{})}):null]}))})),C=Object(b.a)((function(t){return{root:{padding:t.spacing(2),minWidth:320}}}))(p.a),S=Object(b.a)((function(t){return{root:{margin:0,padding:t.spacing(1)}}}))(x.a);function I(t){var e=t.children,a=t.open,i=t.title,c=t.actions,r=t.handleClose;return Object(n.jsx)("form",{noValidate:!0,autoComplete:"off",children:Object(n.jsxs)(h.a,{"aria-labelledby":"customized-dialog-title",open:a,onClose:null!==r&&void 0!==r?r:function(){return null},TransitionProps:{unmountOnExit:!0},children:[i&&Object(n.jsx)(y,{id:"customized-dialog-title",onClose:r,children:i}),Object(n.jsx)(C,{children:e}),Object(n.jsx)(S,{children:c})]})})}function A(t){var e=t.loggedIn,a=void 0!==e&&e,i=t.handleSubmit,r=c.a.useState(""),s=Object(o.a)(r,2),u=s[0],j=s[1],b=Object(n.jsx)(l.a,{type:"submit",onClick:function(t){t.preventDefault(),i({type:"LOGIN",userId:u})},color:"primary",children:"Login"});return Object(n.jsx)(I,{title:"Login",actions:b,open:!a,children:Object(n.jsx)(d.a,{id:"userId",label:"User Id",value:u,fullWidth:!0,autoFocus:!0,onChange:function(t){j(t.target.value)}})})}var N=a(136),w=a(146),E=a(139),k=a(138),_=a(51),T=a.n(_),R=a(140),D=a(137),P=a(49),W=a.n(P),L=a(13),z=a(17),B=a(53),H=a(52),F=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;return Math.random().toString(36).slice(-t)},K=a(24),G=function(){function t(){Object(z.a)(this,t)}return Object(K.a)(t,null,[{key:"set",value:function(t,e){localStorage.setItem(t,JSON.stringify(e))}},{key:"get",value:function(t){var e=localStorage.getItem(t);return JSON.parse(e)}}]),t}(),M=function t(e,a){var n=this;Object(z.a)(this,t),this._persistKey="_a_t_data",this.isExists=function(t){return!!n.data.find((function(e){return e.id===t}))},this.read=function(t){t instanceof Function&&n.data.map((function(e){return t(e)}))},this.readById=function(t){if(t)return n.data.find((function(e){return e.id===t}))},this.update=function(t,e){if(e instanceof Object)for(var a=0;a<n.data;a++){var i=n.data[a];if(i.id===t){n.data[a]=Object(u.a)(Object(u.a)({},i),e),n.data=Object(L.a)(n.data);break}}},this.remove=function(t){t&&(n.data=n.data.filter((function(e){return e.id!==t})))},this.getAll=function(){return n.data},this.persist=function(){G.set(n._persistKey,n.data)},this.retrieve=function(){var t;return null!==(t=G.get(n._persistKey))&&void 0!==t?t:[]},this.userId=e,this._persistKey=this.userId+this._persistKey,this.data=null!==a&&void 0!==a?a:this.retrieve()},U=function(t){Object(B.a)(a,t);var e=Object(H.a)(a);function a(){var t;Object(z.a)(this,a);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(t=e.call.apply(e,[this].concat(i)))._persistKey="_a_t_entities",t.create=function(e){e instanceof J&&t.isExists(e.id)&&(t.data=[].concat(Object(L.a)(t.data),[e]))},t}return a}(M),J=function t(e,a,n){Object(z.a)(this,t),this.id=F(),this.name=e,this.description=a,this.opening_balance=n,this.balance=n},V=Object(N.a)((function(t){return{grid:{textAlign:"right"}}}));function q(t){var e=t.handleAdd,a=V(),i=c.a.useState(""),r=Object(o.a)(i,2),s=r[0],u=r[1],j=c.a.useState(0),b=Object(o.a)(j,2),h=b[0],O=b[1],p=c.a.useState(""),x=Object(o.a)(p,2),m=x[0],f=x[1],g=c.a.useState(!1),v=Object(o.a)(g,2),y=v[0],C=v[1],S=function(){C(!y)};return Object(n.jsxs)("div",{children:[Object(n.jsx)(I,{open:y,actions:Object(n.jsx)(l.a,{onClick:function(t){t.preventDefault(),e(new J(s,m,-h)),S(),u(""),O(0),f("")},color:"primary",children:"Submit"}),title:"New Entity",handleClose:S,children:Object(n.jsxs)(D.a,{container:!0,spacing:1,children:[Object(n.jsx)(D.a,{item:!0,sm:6,children:Object(n.jsx)(d.a,{id:"name",label:"Name",value:s,onChange:function(t){return u(t.target.value)},fullWidth:!0})}),Object(n.jsx)(D.a,{item:!0,sm:6,children:Object(n.jsx)(d.a,{id:"balance",label:"Opening Balance",value:h,onChange:function(t){return O(Number(t.target.value))},type:"number",fullWidth:!0})}),Object(n.jsx)(D.a,{item:!0,sm:12,children:Object(n.jsx)(d.a,{id:"description",label:"Description",value:m,onChange:function(t){return f(t.target.value)},type:"text",multiline:!0,rows:2,fullWidth:!0})})]})}),Object(n.jsx)(D.a,{container:!0,spacing:1,children:Object(n.jsx)(D.a,{item:!0,sm:12,className:a.grid,children:Object(n.jsx)(l.a,{variant:"contained",onClick:S,color:"primary",startIcon:Object(n.jsx)(W.a,{}),children:"Entity"})})})]})}var Q=function(t){Object(B.a)(a,t);var e=Object(H.a)(a);function a(){var t;Object(z.a)(this,a);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(t=e.call.apply(e,[this].concat(i)))._persistKey="_a_t_transactions",t.create=function(e){e instanceof X&&t.isExists(e.id)&&(t.data=[].concat(Object(L.a)(t.data),[e]))},t}return a}(M),X=function t(e,a,n,i,c){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Date.now();Object(z.a)(this,t),this.id=F(),this.time=+new Date(r),this.entityId=e,this.cost=a,this.paid=n,this.payment_mode=i,this.remarks=null!==c&&void 0!==c?c:""},Y=a(92),Z=a(148),$="CREATE",tt="UPDATE",et="DELETE",at={CASH:"CASH",UPI:"UPI",WIRE:"WIRE",WALLET:"WALLET",CARD:"CARD"},nt=Object(N.a)((function(t){return{paper:{margin:"".concat(t.spacing(1),"px 0"),padding:"".concat(t.spacing(1),"px")},grid:{textAlign:"right"},button:{margin:"".concat(t.spacing(1),"px 0")}}}));function it(t){var e=t.handleAdd,a=nt(),i=c.a.useState(Date.now()),r=Object(o.a)(i,2),s=r[0],u=r[1],j=c.a.useState(0),b=Object(o.a)(j,2),h=b[0],O=b[1],p=c.a.useState(0),x=Object(o.a)(p,2),m=x[0],f=x[1],g=c.a.useState(at.CASH),v=Object(o.a)(g,2),y=v[0],C=v[1],S=c.a.useState(""),I=Object(o.a)(S,2),A=I[0],N=I[1],w=c.a.useState(!1),E=Object(o.a)(w,2),k=E[0],_=E[1],T=function(){_(!k)};return Object(n.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[k&&Object(n.jsx)(Y.a,{className:a.paper,children:Object(n.jsxs)(D.a,{container:!0,spacing:1,children:[Object(n.jsx)(D.a,{item:!0,sm:6,xs:12,children:Object(n.jsx)(d.a,{id:"cost",label:"Cost",value:h,onChange:function(t){return O(Number(t.target.value))},type:"number",fullWidth:!0,size:"small"})}),Object(n.jsx)(D.a,{item:!0,sm:6,xs:12,children:Object(n.jsx)(d.a,{id:"paid",label:"Paid",value:m,onChange:function(t){return f(Number(t.target.value))},type:"number",fullWidth:!0,size:"small"})}),Object(n.jsx)(D.a,{item:!0,sm:6,xs:12,children:Object(n.jsx)(d.a,{id:"time",label:"Time",value:s,onChange:function(t){return u(t.target.value)},type:"datetime-local",fullWidth:!0,size:"small"})}),Object(n.jsx)(D.a,{item:!0,sm:6,xs:12,children:Object(n.jsx)(d.a,{id:"payment_mode",select:!0,label:"Payment Mode",value:y,onChange:function(t){return C(t.target.value)},fullWidth:!0,children:Object.keys(at).map((function(t){return Object(n.jsx)(Z.a,{value:t,children:t},t)}))})}),Object(n.jsx)(D.a,{item:!0,xs:12,children:Object(n.jsx)(d.a,{id:"remarks",label:"Remarks",value:A,onChange:function(t){return N(t.target.value)},type:"text",multiline:!0,rows:2,fullWidth:!0,size:"small"})}),Object(n.jsx)(D.a,{item:!0,xs:12,className:a.grid,children:Object(n.jsx)(l.a,{variant:"contained",onClick:function(t){t.preventDefault(),e((function(t){return new X(t,h,m,y,A,s)})),T(),u(Date.now()),O(0),f(0),C(at.CASH),N("")},color:"primary",size:"small",children:"Submit"})})]})}),!k&&Object(n.jsx)(l.a,{onClick:T,color:"primary",startIcon:Object(n.jsx)(W.a,{}),size:"small",className:a.button,children:"Transaction"})]})}var ct=a(10),rt=a(68),st=a.n(rt),ot=Object(N.a)((function(t){return{root:{fontSize:t.typography.pxToRem(15)},debit:{color:t.palette.error.main},credit:{color:t.palette.success.main}}}));function lt(t){var e,a=t.amount,i=t.neutral,c=void 0!==i&&i,r=ot();return Object(n.jsxs)(v.a,{className:st()(r.root,(e={},Object(ct.a)(e,r.debit,!c&&a<0),Object(ct.a)(e,r.credit,!c&&a>0),e)),component:"span",children:["\u20b9 ",Math.abs(a)]})}var dt=Object(N.a)((function(t){return{root:{width:"100%"},secondaryHeading:{fontSize:t.typography.pxToRem(15),color:t.palette.text.secondary},header:{"&>.MuiGrid-item:not(:first-child)":{textAlign:"right"}}}}));function ut(t){var e=t.id,a=t.time,i=t.cost,r=t.paid,s=t.payment_mode,l=t.remarks,d=dt(),u=c.a.useState(!1),j=Object(o.a)(u,2),b=j[0],h=j[1];return Object(n.jsxs)(w.a,{expanded:b,onChange:function(t,e){h(e)},TransitionProps:{unmountOnExit:!0},children:[Object(n.jsx)(k.a,{expandIcon:Object(n.jsx)(T.a,{}),"aria-controls":"content",id:e,children:Object(n.jsxs)(D.a,{container:!0,spacing:1,className:d.header,children:[Object(n.jsx)(D.a,{item:!0,sm:3,xs:6,children:Object(n.jsx)(v.a,{children:new Date(a).toLocaleString()})}),Object(n.jsx)(D.a,{item:!0,sm:3,xs:6,children:Object(n.jsx)(lt,{amount:i,neutral:!0})}),Object(n.jsxs)(D.a,{item:!0,sm:3,xs:6,children:[Object(n.jsx)(lt,{amount:-r}),Object(n.jsxs)(v.a,{component:"span",variant:"caption",children:["(",s,")"]})]}),Object(n.jsx)(D.a,{item:!0,sm:3,xs:6,children:Object(n.jsx)(lt,{amount:i-r})})]})}),Object(n.jsx)(E.a,{children:Object(n.jsx)(v.a,{className:d.secondaryHeading,children:l})})]})}function jt(t){var e=t.entityId,a=t.data,i=t.dispatch;dt();return Object(n.jsxs)(D.a,{container:!0,children:[Object(n.jsx)(D.a,{item:!0,sm:12,children:a.map((function(t){return Object(n.jsx)(ut,Object(u.a)({},t),t.id)}))}),Object(n.jsx)(D.a,{item:!0,sm:12,children:Object(n.jsx)(it,{handleAdd:function(t){var a=t(e);i({type:$,payload:a})}})})]})}var bt=Object(N.a)((function(t){return{root:{width:"100%",margin:"".concat(t.spacing(1),"px 0")},heading:{fontSize:t.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:t.typography.pxToRem(15),flexBasis:"66.66%",flexShrink:0,textAlign:"right",marginRight:t.spacing(2)},paper:{padding:t.spacing(1)},divider:{margin:"".concat(t.spacing(1),"px 0")},rightAlign:{textAlign:"right"}}}));function ht(t){var e=t.id,a=t.name,i=t.description,r=t.balance,s=t.opening_balance,l=t.transactions,d=t.transactionProps,j=bt(),b=c.a.useState(!1),h=Object(o.a)(b,2),O=h[0],p=h[1];return Object(n.jsxs)(w.a,{expanded:O,onChange:function(t,e){p(e)},TransitionProps:{unmountOnExit:!0},children:[Object(n.jsxs)(k.a,{expandIcon:Object(n.jsx)(T.a,{}),"aria-controls":"content",id:e,children:[Object(n.jsx)(v.a,{className:j.heading,children:a}),Object(n.jsx)("div",{className:j.secondaryHeading,children:Object(n.jsx)(lt,{amount:r})})]}),Object(n.jsx)(R.a,{}),Object(n.jsx)(E.a,{children:Object(n.jsxs)(D.a,{container:!0,spacing:2,children:[Object(n.jsxs)(D.a,{item:!0,sm:3,children:[Object(n.jsx)(v.a,{variant:"caption",children:"Opening balance"}),Object(n.jsx)(v.a,{variant:"body2",children:Object(n.jsx)(lt,{amount:s})}),Object(n.jsx)(R.a,{className:j.divider}),Object(n.jsx)(v.a,{variant:"caption",children:"Description"}),Object(n.jsx)(v.a,{variant:"body2",children:i})]}),Object(n.jsx)(D.a,{item:!0,xs:12,sm:9,children:Object(n.jsx)(jt,Object(u.a)({entityId:e,data:l},d))})]})})]})}function Ot(t){var e,a=t.data,i=t.dispatch,c=t.transactionProps,r=bt();return Object(n.jsxs)(D.a,{container:!0,className:r.root,spacing:2,children:[Object(n.jsx)(D.a,{item:!0,sm:9,className:r.rightAlign,children:Object(n.jsxs)(v.a,{component:"div",variant:"subtitle1",children:["Total: ",Object(n.jsx)(lt,{amount:a.balance})]})}),Object(n.jsx)(D.a,{item:!0,sm:3,children:Object(n.jsx)(q,{handleAdd:function(t){i({type:$,payload:t})}})}),Object(n.jsx)(D.a,{item:!0,sm:12,children:null===(e=a.entities)||void 0===e?void 0:e.map((function(t){return Object(n.jsx)(ht,Object(u.a)(Object(u.a)({},t),{},{transactionProps:c}),t.id)}))})]})}var pt=a(141),xt=a(142),mt=a(69),ft=a.n(mt),gt=a(143),vt=Object(N.a)((function(t){return{root:{flexGrow:1},menuButton:{marginRight:t.spacing(2)},title:{flexGrow:1}}}));function yt(t){var e=t.userId,a=t.children,i=vt();return Object(n.jsxs)("div",{className:i.root,children:[Object(n.jsx)(pt.a,{position:"static",children:Object(n.jsxs)(xt.a,{children:[Object(n.jsx)(v.a,{variant:"h6",className:i.title,children:"Tula"}),Object(n.jsx)("div",{children:e?Object(n.jsx)(v.a,{variant:"h6",className:i.title,children:e}):Object(n.jsx)(m.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",color:"inherit",children:Object(n.jsx)(ft.a,{})})})]})}),Object(n.jsx)(gt.a,{children:e&&a})]})}function Ct(t,e){var a=e.type,n=e.userId;switch(a){case"LOGIN":return{userId:n};case"LOGOUT":return{};default:throw new Error}}function St(t,e){var a=t;switch(e.type){case $:a=[].concat(Object(L.a)(t),[e.payload]);break;case tt:var n=t.findIndex((function(t){return t.id===e.id}));if(n>0){var i=Object(u.a)(Object(u.a)({},t[n]),e.payload);a=[].concat(Object(L.a)(t.slice(0,n)),[i],Object(L.a)(t.slice(n+1)))}break;case et:a=t.filter((function(t){return e.queryFn(t)}));break;default:throw new Error}return a}var It=function(){var t=c.a.useReducer(Ct,{}),e=Object(o.a)(t,2),a=e[0].userId,r=e[1],s=c.a.useReducer(St,[]),l=Object(o.a)(s,2),d=l[0],j=l[1],b=c.a.useReducer(St,[]),h=Object(o.a)(b,2),O=h[0],p=h[1],x=c.a.useState({}),m=Object(o.a)(x,2),f=m[0],g=m[1];return Object(i.useEffect)((function(){a&&g(function(t,e){var a={balance:0,entities:[]};return console.log(t,e),Array.isArray(t)&&Array.isArray(e)&&(a.entities=Object(L.a)(t).map((function(t){var n=Object(u.a)({},t),i=e.filter((function(t){return t.entityId===n.id&&(n.balance+=t.cost-t.paid,!0)}));return a.balance+=+n.balance,Object(u.a)(Object(u.a)({},n),{},{transactions:i})}))),a}(d,O))}),[a,d,O]),function(t,e,a){var n=c.a.useRef({});c.a.useEffect((function(){var i=n.current,c=i.entity,r=i.transaction;!t||c||r||(n.current.entity=new U(t,e),n.current.transaction=new Q(t,a)),c&&r&&(c.data=e,r.data=a,console.log(c,r),c.persist(),r.persist())}),[t,e,a])}(a,d,O),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(A,{loggedIn:!!a,handleSubmit:r}),Object(n.jsx)(yt,{userId:a,children:Object(n.jsx)(Ot,{data:f,dispatch:j,transactionProps:{dispatch:p}})})]})},At=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,150)).then((function(e){var a=e.getCLS,n=e.getFID,i=e.getFCP,c=e.getLCP,r=e.getTTFB;a(t),n(t),i(t),c(t),r(t)}))};s.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(It,{})}),document.getElementById("root")),At()}},[[89,1,2]]]);
//# sourceMappingURL=main.822b41d5.chunk.js.map