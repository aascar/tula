(this.webpackJsonptula=this.webpackJsonptula||[]).push([[0],{89:function(t,e,a){"use strict";a.r(e);var n=a(2),i=a(0),c=a.n(i),r=a(12),s=a.n(r),o=a(8),l=a(135),d=a(144),u=a(14),j=a(3),b=a(5),h=a(147),O=a(132),p=a(133),x=a(134),m=a(91),f=a(67),g=a.n(f),v=a(90),y=Object(b.a)((function(t){return{root:{margin:0,padding:t.spacing(2)},closeButton:{position:"absolute",right:t.spacing(1),top:t.spacing(1),color:t.palette.grey[500]}}}))((function(t){var e=t.children,a=t.classes,i=t.onClose,c=Object(j.a)(t,["children","classes","onClose"]);return Object(n.jsxs)(O.a,Object(u.a)(Object(u.a)({disableTypography:!0,className:a.root},c),{},{children:[Object(n.jsx)(v.a,{variant:"h6",children:e}),i?Object(n.jsx)(m.a,{"aria-label":"close",className:a.closeButton,onClick:i,children:Object(n.jsx)(g.a,{})}):null]}))})),C=Object(b.a)((function(t){return{root:{padding:t.spacing(2),minWidth:320}}}))(p.a),S=Object(b.a)((function(t){return{root:{margin:0,padding:t.spacing(1)}}}))(x.a);function I(t){var e=t.children,a=t.open,i=t.title,c=t.actions,r=t.handleClose;return Object(n.jsx)("form",{noValidate:!0,autoComplete:"off",children:Object(n.jsxs)(h.a,{"aria-labelledby":"customized-dialog-title",open:a,onClose:null!==r&&void 0!==r?r:function(){return null},TransitionProps:{unmountOnExit:!0},children:[i&&Object(n.jsx)(y,{id:"customized-dialog-title",onClose:r,children:i}),Object(n.jsx)(C,{children:e}),Object(n.jsx)(S,{children:c})]})})}function A(t){var e=t.loggedIn,a=void 0!==e&&e,i=t.handleSubmit,r=c.a.useState(""),s=Object(o.a)(r,2),u=s[0],j=s[1],b=Object(n.jsx)(l.a,{type:"submit",onClick:function(t){t.preventDefault(),i({type:"LOGIN",userId:u})},color:"primary",children:"Login"});return Object(n.jsx)(I,{title:"Login",actions:b,open:!a,children:Object(n.jsx)(d.a,{id:"userId",label:"User Id",value:u,fullWidth:!0,autoFocus:!0,onChange:function(t){j(t.target.value)}})})}var N=a(136),E=a(146),_=a(139),w=a(138),k=a(51),T=a.n(k),R=a(140),D=a(137),L=a(49),P=a.n(L),W=a(13),z=a(17),K=a(53),B=a(52),H=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;return Math.random().toString(36).slice(-t)},F=a(24),G=function(){function t(){Object(z.a)(this,t)}return Object(F.a)(t,null,[{key:"set",value:function(t,e){localStorage.setItem(t,JSON.stringify(e))}},{key:"get",value:function(t){var e=localStorage.getItem(t);return JSON.parse(e)}}]),t}(),U=function t(e){var a=this;Object(z.a)(this,t),this._persistKey="_a_t_data",this.isExists=function(t){return!!a.data.find((function(e){return e.id===t}))},this.read=function(t){t instanceof Function&&a.data.map((function(e){return t(e)}))},this.readById=function(t){if(t)return a.data.find((function(e){return e.id===t}))},this.update=function(t,e){if(e instanceof Object)for(var n=0;n<a.data;n++){var i=a.data[n];if(i.id===t){a.data[n]=Object(u.a)(Object(u.a)({},i),e),a.data=Object(W.a)(a.data);break}}},this.remove=function(t){t&&(a.data=a.data.filter((function(e){return e.id!==t})))},this.getAll=function(){return a.data},this.persist=function(){G.set(a._persistKey,a.data)},this.retrieve=function(){var t;return console.info(a._persistKey),null!==(t=G.get(a._persistKey))&&void 0!==t?t:[]},this.userId=e},M=function(t){Object(K.a)(a,t);var e=Object(B.a)(a);function a(t){var n;return Object(z.a)(this,a),(n=e.call(this,t))._persistKey="_a_t_entities",n.create=function(t){t instanceof J&&n.isExists(t.id)&&(n.data=[].concat(Object(W.a)(n.data),[t]))},n._persistKey=n.userId+n._persistKey,n.data=n.retrieve(),n}return a}(U),J=function t(e,a,n){Object(z.a)(this,t),this.id=H(),this.name=e,this.description=a,this.opening_balance=n,this.balance=n},V=Object(N.a)((function(t){return{grid:{textAlign:"right"}}}));function q(t){var e=t.handleAdd,a=V(),i=c.a.useState(""),r=Object(o.a)(i,2),s=r[0],u=r[1],j=c.a.useState(0),b=Object(o.a)(j,2),h=b[0],O=b[1],p=c.a.useState(""),x=Object(o.a)(p,2),m=x[0],f=x[1],g=c.a.useState(!1),v=Object(o.a)(g,2),y=v[0],C=v[1],S=function(){C(!y)};return Object(n.jsxs)("div",{children:[Object(n.jsx)(I,{open:y,actions:Object(n.jsx)(l.a,{onClick:function(t){t.preventDefault(),e(new J(s,m,-h)),S(),u(""),O(0),f("")},color:"primary",children:"Submit"}),title:"New Entity",handleClose:S,children:Object(n.jsxs)(D.a,{container:!0,spacing:1,children:[Object(n.jsx)(D.a,{item:!0,sm:6,children:Object(n.jsx)(d.a,{id:"name",label:"Name",value:s,onChange:function(t){return u(t.target.value)},fullWidth:!0})}),Object(n.jsx)(D.a,{item:!0,sm:6,children:Object(n.jsx)(d.a,{id:"balance",label:"Opening Balance",value:h,onChange:function(t){return O(Number(t.target.value))},type:"number",fullWidth:!0})}),Object(n.jsx)(D.a,{item:!0,sm:12,children:Object(n.jsx)(d.a,{id:"description",label:"Description",value:m,onChange:function(t){return f(t.target.value)},type:"text",multiline:!0,rows:2,fullWidth:!0})})]})}),Object(n.jsx)(D.a,{container:!0,spacing:1,children:Object(n.jsx)(D.a,{item:!0,sm:12,className:a.grid,children:Object(n.jsx)(l.a,{variant:"contained",onClick:S,color:"primary",startIcon:Object(n.jsx)(P.a,{}),children:"Entity"})})})]})}var Q=function(t){Object(K.a)(a,t);var e=Object(B.a)(a);function a(t){var n;return Object(z.a)(this,a),(n=e.call(this,t))._persistKey="_a_t_transactions",n.create=function(t){t instanceof X&&n.isExists(t.id)&&(n.data=[].concat(Object(W.a)(n.data),[t]))},n._persistKey=n.userId+n._persistKey,n.data=n.retrieve(),n}return a}(U),X=function t(e,a,n,i,c){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Date.now();Object(z.a)(this,t),this.id=H(),this.time=+new Date(r),this.entityId=e,this.cost=a,this.paid=n,this.payment_mode=i,this.remarks=null!==c&&void 0!==c?c:""},Y=a(92),Z=a(148),$="CREATE",tt="UPDATE",et="DELETE",at="BULK_CREATE",nt={CASH:"CASH",UPI:"UPI",WIRE:"WIRE",WALLET:"WALLET",CARD:"CARD"},it=Object(N.a)((function(t){return{paper:{margin:"".concat(t.spacing(1),"px 0"),padding:"".concat(t.spacing(1),"px")},grid:{textAlign:"right"},button:{margin:"".concat(t.spacing(1),"px 0")}}}));function ct(t){var e=t.handleAdd,a=it(),i=c.a.useState(Date.now()),r=Object(o.a)(i,2),s=r[0],u=r[1],j=c.a.useState(0),b=Object(o.a)(j,2),h=b[0],O=b[1],p=c.a.useState(0),x=Object(o.a)(p,2),m=x[0],f=x[1],g=c.a.useState(nt.CASH),v=Object(o.a)(g,2),y=v[0],C=v[1],S=c.a.useState(""),I=Object(o.a)(S,2),A=I[0],N=I[1],E=c.a.useState(!1),_=Object(o.a)(E,2),w=_[0],k=_[1],T=function(){k(!w)};return Object(n.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[w&&Object(n.jsx)(Y.a,{className:a.paper,children:Object(n.jsxs)(D.a,{container:!0,spacing:1,children:[Object(n.jsx)(D.a,{item:!0,sm:6,xs:12,children:Object(n.jsx)(d.a,{id:"cost",label:"Cost",value:h,onChange:function(t){return O(Number(t.target.value))},type:"number",fullWidth:!0,size:"small"})}),Object(n.jsx)(D.a,{item:!0,sm:6,xs:12,children:Object(n.jsx)(d.a,{id:"paid",label:"Paid",value:m,onChange:function(t){return f(Number(t.target.value))},type:"number",fullWidth:!0,size:"small"})}),Object(n.jsx)(D.a,{item:!0,sm:6,xs:12,children:Object(n.jsx)(d.a,{id:"time",label:"Time",value:s,onChange:function(t){return u(t.target.value)},type:"datetime-local",fullWidth:!0,size:"small"})}),Object(n.jsx)(D.a,{item:!0,sm:6,xs:12,children:Object(n.jsx)(d.a,{id:"payment_mode",select:!0,label:"Payment Mode",value:y,onChange:function(t){return C(t.target.value)},fullWidth:!0,children:Object.keys(nt).map((function(t){return Object(n.jsx)(Z.a,{value:t,children:t},t)}))})}),Object(n.jsx)(D.a,{item:!0,xs:12,children:Object(n.jsx)(d.a,{id:"remarks",label:"Remarks",value:A,onChange:function(t){return N(t.target.value)},type:"text",multiline:!0,rows:2,fullWidth:!0,size:"small"})}),Object(n.jsx)(D.a,{item:!0,xs:12,className:a.grid,children:Object(n.jsx)(l.a,{variant:"contained",onClick:function(t){t.preventDefault(),e((function(t){return new X(t,h,m,y,A,s)})),T(),u(Date.now()),O(0),f(0),C(nt.CASH),N("")},color:"primary",size:"small",children:"Submit"})})]})}),!w&&Object(n.jsx)(l.a,{onClick:T,color:"primary",startIcon:Object(n.jsx)(P.a,{}),size:"small",className:a.button,children:"Transaction"})]})}var rt=a(10),st=a(68),ot=a.n(st),lt=Object(N.a)((function(t){return{root:{fontSize:t.typography.pxToRem(15)},debit:{color:t.palette.error.main},credit:{color:t.palette.success.main}}}));function dt(t){var e,a=t.amount,i=t.neutral,c=void 0!==i&&i,r=lt();return Object(n.jsxs)(v.a,{className:ot()(r.root,(e={},Object(rt.a)(e,r.debit,!c&&a<0),Object(rt.a)(e,r.credit,!c&&a>0),e)),component:"span",children:["\u20b9 ",Math.abs(a)]})}var ut=Object(N.a)((function(t){return{root:{width:"100%"},secondaryHeading:{fontSize:t.typography.pxToRem(15),color:t.palette.text.secondary},header:{"&>.MuiGrid-item:not(:first-child)":{textAlign:"right"}}}}));function jt(t){var e=t.id,a=t.time,i=t.cost,r=t.paid,s=t.payment_mode,l=t.remarks,d=ut(),u=c.a.useState(!1),j=Object(o.a)(u,2),b=j[0],h=j[1];return Object(n.jsxs)(E.a,{expanded:b,onChange:function(t,e){h(e)},TransitionProps:{unmountOnExit:!0},children:[Object(n.jsx)(w.a,{expandIcon:Object(n.jsx)(T.a,{}),"aria-controls":"content",id:e,children:Object(n.jsxs)(D.a,{container:!0,spacing:1,className:d.header,children:[Object(n.jsx)(D.a,{item:!0,sm:3,xs:6,children:Object(n.jsx)(v.a,{children:new Date(a).toLocaleString()})}),Object(n.jsx)(D.a,{item:!0,sm:3,xs:6,children:Object(n.jsx)(dt,{amount:i,neutral:!0})}),Object(n.jsxs)(D.a,{item:!0,sm:3,xs:6,children:[Object(n.jsx)(dt,{amount:-r}),Object(n.jsxs)(v.a,{component:"span",variant:"caption",children:["(",s,")"]})]}),Object(n.jsx)(D.a,{item:!0,sm:3,xs:6,children:Object(n.jsx)(dt,{amount:i-r})})]})}),Object(n.jsx)(_.a,{children:Object(n.jsx)(v.a,{className:d.secondaryHeading,children:l})})]})}function bt(t){var e=t.entityId,a=t.data,i=t.dispatch;ut();return Object(n.jsxs)(D.a,{container:!0,children:[Object(n.jsx)(D.a,{item:!0,sm:12,children:a.map((function(t){return Object(n.jsx)(jt,Object(u.a)({},t),t.id)}))}),Object(n.jsx)(D.a,{item:!0,sm:12,children:Object(n.jsx)(ct,{handleAdd:function(t){var a=t(e);i({type:$,payload:a})}})})]})}var ht=Object(N.a)((function(t){return{root:{width:"100%",margin:"".concat(t.spacing(1),"px 0")},heading:{fontSize:t.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:t.typography.pxToRem(15),flexBasis:"66.66%",flexShrink:0,textAlign:"right",marginRight:t.spacing(2)},paper:{padding:t.spacing(1)},divider:{margin:"".concat(t.spacing(1),"px 0")},rightAlign:{textAlign:"right"}}}));function Ot(t){var e=t.id,a=t.name,i=t.description,r=t.balance,s=t.opening_balance,l=t.transactions,d=t.transactionProps,j=ht(),b=c.a.useState(!1),h=Object(o.a)(b,2),O=h[0],p=h[1];return Object(n.jsxs)(E.a,{expanded:O,onChange:function(t,e){p(e)},TransitionProps:{unmountOnExit:!0},children:[Object(n.jsxs)(w.a,{expandIcon:Object(n.jsx)(T.a,{}),"aria-controls":"content",id:e,children:[Object(n.jsx)(v.a,{className:j.heading,children:a}),Object(n.jsx)("div",{className:j.secondaryHeading,children:Object(n.jsx)(dt,{amount:r})})]}),Object(n.jsx)(R.a,{}),Object(n.jsx)(_.a,{children:Object(n.jsxs)(D.a,{container:!0,spacing:2,children:[Object(n.jsxs)(D.a,{item:!0,sm:3,children:[Object(n.jsx)(v.a,{variant:"caption",children:"Opening balance"}),Object(n.jsx)(v.a,{variant:"body2",children:Object(n.jsx)(dt,{amount:s})}),Object(n.jsx)(R.a,{className:j.divider}),Object(n.jsx)(v.a,{variant:"caption",children:"Description"}),Object(n.jsx)(v.a,{variant:"body2",children:i})]}),Object(n.jsx)(D.a,{item:!0,xs:12,sm:9,children:Object(n.jsx)(bt,Object(u.a)({entityId:e,data:l},d))})]})})]})}function pt(t){var e,a=t.data,i=t.dispatch,c=t.transactionProps,r=ht();return Object(n.jsxs)(D.a,{container:!0,className:r.root,spacing:2,children:[Object(n.jsx)(D.a,{item:!0,sm:9,className:r.rightAlign,children:Object(n.jsxs)(v.a,{component:"div",variant:"subtitle1",children:["Total: ",Object(n.jsx)(dt,{amount:a.balance})]})}),Object(n.jsx)(D.a,{item:!0,sm:3,children:Object(n.jsx)(q,{handleAdd:function(t){i({type:$,payload:t})}})}),Object(n.jsx)(D.a,{item:!0,sm:12,children:null===(e=a.entities)||void 0===e?void 0:e.map((function(t){return Object(n.jsx)(Ot,Object(u.a)(Object(u.a)({},t),{},{transactionProps:c}),t.id)}))})]})}var xt=a(141),mt=a(142),ft=a(69),gt=a.n(ft),vt=a(143),yt=Object(N.a)((function(t){return{root:{flexGrow:1},menuButton:{marginRight:t.spacing(2)},title:{flexGrow:1}}}));function Ct(t){var e=t.userId,a=t.children,i=yt();return Object(n.jsxs)("div",{className:i.root,children:[Object(n.jsx)(xt.a,{position:"static",children:Object(n.jsxs)(mt.a,{children:[Object(n.jsx)(v.a,{variant:"h6",className:i.title,children:"Tula"}),Object(n.jsx)("div",{children:e?Object(n.jsx)(v.a,{variant:"h6",className:i.title,children:e}):Object(n.jsx)(m.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",color:"inherit",children:Object(n.jsx)(gt.a,{})})})]})}),Object(n.jsx)(vt.a,{children:e&&a})]})}function St(t,e){var a=e.type,n=e.userId;switch(a){case"LOGIN":return{userId:n};case"LOGOUT":return{};default:throw new Error}}function It(t,e){var a=t;switch(e.type){case at:a=[].concat(Object(W.a)(t),Object(W.a)(e.payload));break;case $:a=[].concat(Object(W.a)(t),[e.payload]);break;case tt:var n=t.findIndex((function(t){return t.id===e.id}));if(n>0){var i=Object(u.a)(Object(u.a)({},t[n]),e.payload);a=[].concat(Object(W.a)(t.slice(0,n)),[i],Object(W.a)(t.slice(n+1)))}break;case et:a=t.filter((function(t){return e.queryFn(t)}));break;default:throw new Error}return a}var At=function(){var t=c.a.useReducer(St,{}),e=Object(o.a)(t,2),a=e[0].userId,r=e[1],s=c.a.useReducer(It,[]),l=Object(o.a)(s,2),d=l[0],j=l[1],b=c.a.useReducer(It,[]),h=Object(o.a)(b,2),O=h[0],p=h[1],x=c.a.useState({}),m=Object(o.a)(x,2),f=m[0],g=m[1];return Object(i.useEffect)((function(){a&&g(function(t,e){var a={balance:0,entities:[]};return Array.isArray(t)&&Array.isArray(e)&&(a.entities=Object(W.a)(t).map((function(t){var n=Object(u.a)({},t),i=e.filter((function(t){return t.entityId===n.id&&(n.balance+=t.cost-t.paid,!0)}));return a.balance+=+n.balance,Object(u.a)(Object(u.a)({},n),{},{transactions:i})}))),a}(d,O))}),[a,d,O]),function(t,e,a,n,i){var r=c.a.useRef({});c.a.useEffect((function(){var c=r.current,s=c.entity,o=c.transaction;!t||s||o||(r.current.entity=new M(t),r.current.transaction=new Q(t),n({type:at,payload:r.current.entity.data}),i({type:at,payload:r.current.transaction.data})),r.current.entity&&r.current.transaction&&(e.length&&(s.data=e,s.persist()),a.length&&(o.data=a,o.persist()))}),[t,e,a,n,i])}(a,d,O,j,p),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(A,{loggedIn:!!a,handleSubmit:r}),Object(n.jsx)(Ct,{userId:a,children:Object(n.jsx)(pt,{data:f,dispatch:j,transactionProps:{dispatch:p}})})]})},Nt=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,150)).then((function(e){var a=e.getCLS,n=e.getFID,i=e.getFCP,c=e.getLCP,r=e.getTTFB;a(t),n(t),i(t),c(t),r(t)}))};s.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(At,{})}),document.getElementById("root")),Nt()}},[[89,1,2]]]);
//# sourceMappingURL=main.77901bb1.chunk.js.map